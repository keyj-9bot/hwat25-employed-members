{% extends "base.html" %}
{% block content %}

<h3 class="fw-bold mb-3">ğŸ“¢ êµìˆ˜ ë©”ì‹œì§€ ê´€ë¦¬</h3>

<form method="POST">
  <textarea name="content" class="form-control mb-2" rows="3" placeholder="ìƒˆë¡œìš´ ê³µì§€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" required></textarea>
  <button type="submit" class="btn btn-primary w-100">â• ìƒˆ ë©”ì‹œì§€ ë“±ë¡</button>
</form>

<hr>

{% if messages and messages|length > 0 %}
  {% for m in messages %}
  <div class="border p-3 mb-3 bg-light rounded shadow-sm">
    <p class="mb-1">{{ m.content }}</p>
    <small class="text-muted">{{ m.date }}</small>

    {% if m.status == "confirmed" %}
      <form method="POST" action="{{ url_for('confirm_message', m_id=m.id) }}">
        <button class="btn btn-success btn-sm w-100 mt-2">ğŸ“¢ ê²Œì‹œ í™•ì •</button>
      </form>
    {% elif m.status == "done" %}
      <button class="btn btn-secondary btn-sm w-100 mt-2" disabled>âœ… ê²Œì‹œ ì™„ë£Œ</button>
    {% elif m.status == "edited" %}
      <form method="POST" action="{{ url_for('confirm_message', m_id=m.id) }}">
        <button class="btn btn-warning btn-sm w-100 mt-2">â™»ï¸ ìˆ˜ì • ê²Œì‹œ</button>
      </form>
    {% endif %}

    <form method="POST" action="{{ url_for('edit_message', m_id=m.id) }}" class="mt-2">
      <textarea name="content" class="form-control mb-2" rows="2">{{ m.content }}</textarea>
      <button class="btn btn-outline-info btn-sm w-100">âœï¸ ìˆ˜ì •</button>
    </form>

    <form method="POST" action="{{ url_for('delete_message', m_id=m.id) }}">
      <button class="btn btn-outline-danger btn-sm w-100 mt-1">ğŸ—‘ï¸ ì‚­ì œ</button>
    </form>
  </div>
  {% endfor %}
{% else %}
  <p class="text-muted">ë“±ë¡ëœ ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
{% endif %}

{% endblock %}

