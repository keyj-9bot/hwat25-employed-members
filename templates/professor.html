{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <h3 class="fw-bold mb-3">ğŸ“¢ êµìˆ˜ ë©”ì‹œì§€ ê´€ë¦¬</h3>

  <!-- ë©”ì‹œì§€ ë“±ë¡/ìˆ˜ì • í¼ -->
  <form method="POST" class="mb-4">
    <input type="hidden" name="edit_id" id="edit_id" value="">
    <input type="text" name="title" id="title" class="form-control mb-2" placeholder="ë©”ì‹œì§€ ì œëª©" required>
    <textarea name="content" id="content" class="form-control mb-2" rows="3" placeholder="ë©”ì‹œì§€ ë‚´ìš©" required></textarea>
    <button type="submit" class="btn btn-success w-100">ğŸ’¬ ì €ì¥ / ìˆ˜ì •</button>
  </form>

  <hr>
  <h5 class="fw-bold mb-3">ğŸ“‹ ë“±ë¡ëœ ë©”ì‹œì§€</h5>

  {% if messages and messages|length > 0 %}
    {% for msg in messages %}
    <div class="border rounded p-3 mb-3 bg-light shadow-sm">
      <h5 class="fw-bold">{{ msg.title }}</h5>
      <p>{{ msg.content }}</p>
      <small class="text-muted">ì‘ì„±ì¼: {{ msg.date }}</small>

      <div class="mt-2">
        {% if msg.status == "confirmed" %}
          <span class="badge bg-success">ê²Œì‹œ ì™„ë£Œ</span>
        {% else %}
          <a href="{{ url_for('professor_page', confirm=msg.id) }}" class="btn btn-sm btn-outline-success">âœ… ê²Œì‹œ í™•ì •</a>
        {% endif %}

        <button type="button" class="btn btn-sm btn-outline-primary" 
                onclick="editMessage('{{ msg.id }}', '{{ msg.title|escape }}', '{{ msg.content|escape }}')">âœï¸ ìˆ˜ì •</button>

        <a href="{{ url_for('professor_page', delete=msg.id) }}" 
           class="btn btn-sm btn-outline-danger"
           onclick="return confirm('ì´ ë©”ì‹œì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ğŸ—‘ï¸ ì‚­ì œ</a>
      </div>
    </div>
    {% endfor %}
  {% else %}
    <p class="text-muted">ë“±ë¡ëœ ë©”ì‹œì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
  {% endif %}
</div>

<script>
function editMessage(id, title, content) {
  document.getElementById("edit_id").value = id;
  document.getElementById("title").value = title;
  document.getElementById("content").value = content;
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>
{% endblock %}


