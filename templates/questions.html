{% extends "base.html" %}
{% block content %}
<h2>ğŸ’¬ ì§ˆë¬¸ ê²Œì‹œíŒ</h2>

<form method="POST" enctype="multipart/form-data">
  <input name="title" placeholder="ì œëª©" required><br>
  <textarea name="content" placeholder="ë‚´ìš©" required></textarea><br>
  <input type="file" name="files" multiple><br>
  <button type="submit">ë“±ë¡</button>
</form>

<hr>
{% for q in questions %}
<div style="border:1px solid #ccc; padding:10px; margin-bottom:10px;">
  <b>{{ q.title }}</b> ({{ q.email }} / {{ q.date }})<br>
  {{ q.content }}<br>
  {% if q.files %}
    ì²¨ë¶€íŒŒì¼:
    {% for f in q.files.split(';') %}
      <a href="{{ url_for('download_file', filename=f) }}">{{ f }}</a>
    {% endfor %}
  {% endif %}
  <form method="POST" action="{{ url_for('edit_question', q_id=q.id) }}">
    <input name="title" value="{{ q.title }}">
    <textarea name="content">{{ q.content }}</textarea>
    <button type="submit">ìˆ˜ì •</button>
  </form>
  <a href="{{ url_for('delete_question', q_id=q.id) }}">ì‚­ì œ</a>
</div>
{% endfor %}

<!-- íŒì—… ì˜ì—­ -->
<div id="popup" style="display:none; position:fixed; bottom:20px; right:20px; background:#fff; border:2px solid #444; padding:10px; box-shadow:0px 0px 10px rgba(0,0,0,0.3);">
  <h4 id="popup-title"></h4>
  <p id="popup-content"></p>
</div>

<script>
async function checkPopup() {
  const res = await fetch("/popup_message");
  const data = await res.json();
  if (data.title) {
    document.getElementById("popup-title").textContent = data.title;
    document.getElementById("popup-content").textContent = data.content;
    document.getElementById("popup").style.display = "block";
  } else {
    document.getElementById("popup").style.display = "none";
  }
}
setInterval(checkPopup, 4000);
checkPopup();
</script>

<a href="{{ url_for('logout') }}">ë¡œê·¸ì•„ì›ƒ</a>
{% endblock %}
